# Интеграция заказов материалов с порталом Inspections-Checklist-Portal

## Описание функциональности

Данная интеграция обеспечивает автоматическую миграцию заказов материалов в раздел Supplies портала Inspections-Checklist-Portal. Когда пользователь создает заказ материалов через корзину в модуле материалов (добавляет товары, добавляет комментарий Order Notes и нажимает кнопку Submit Order), заказ автоматически отправляется в модуль Supplies в Inspections-Checklist-Portal и отображается там в виде карточки.

## Установка и настройка

1. **Создайте необходимые таблицы базы данных:**

   Запустите скрипт настройки базы данных:

   ```
   http://localhost/Maintenance_P/Inspections-Checklist-Portal/api/setup_supplies_db.php
   ```

   Этот скрипт создаст две необходимые таблицы:

   - `supply_orders` - для хранения информации о заказах
   - `supply_order_items` - для хранения элементов заказа

2. **Проверьте наличие всех необходимых файлов:**

   - `Inspections-Checklist-Portal/api/supplies-api.php` - API для обработки запросов
   - `Inspections-Checklist-Portal/api/create_supplies_tables.sql` - SQL скрипт для создания таблиц
   - `Inspections-Checklist-Portal/scripts/components/supplies/SuppliesManager.js` - обновленный менеджер Supplies
   - `Inspections-Checklist-Portal/styles/components/supplies/supplies.css` - стили для карточек заказов

## Тестирование функциональности

1. **Создание заказа материалов:**

   - Откройте страницу материалов
   - Добавьте несколько материалов в корзину
   - Нажмите на иконку корзины, чтобы открыть модальное окно корзины
   - Добавьте комментарий в поле Order Notes
   - Нажмите кнопку Submit Order
   - Убедитесь, что появляется уведомление об успешном создании заказа

2. **Проверка миграции заказа в Inspections-Checklist-Portal:**

   - Откройте портал Inspections-Checklist-Portal
   - Перейдите в раздел Supplies
   - Убедитесь, что ваш заказ отображается в виде карточки с соответствующими данными:
     - Идентификатор заказа
     - Статус (по умолчанию "Pending")
     - Имя пользователя, создавшего заказ
     - Дата создания
     - Список элементов заказа
     - Комментарий (Order Notes)

3. **Управление заказом в Supplies:**

   В разделе Supplies вы можете выполнять следующие действия с заказом:

   - Для заказа со статусом "Pending":

     - Process Order - изменить статус на "Processing"
     - Cancel - отменить заказ

   - Для заказа со статусом "Processing":
     - Complete Order - пометить заказ как выполненный
     - Cancel - отменить заказ

## Отладка и решение проблем

Если заказы не отображаются в разделе Supplies, проверьте консоль браузера на наличие ошибок:

1. Откройте инструменты разработчика в браузере (F12 или Ctrl+Shift+I)
2. Перейдите на вкладку Console
3. Проверьте наличие сообщений об ошибках

Типичные проблемы:

1. **Ошибки соединения с API**:

   - Убедитесь, что путь к API указан правильно
   - Проверьте доступность API по адресу: `/Inspections-Checklist-Portal/api/supplies-api.php`

2. **Ошибки базы данных**:
   - Убедитесь, что таблицы созданы правильно
   - Проверьте права доступа к базе данных

## Контактная информация

По вопросам работы интеграции обращайтесь к администратору системы.
